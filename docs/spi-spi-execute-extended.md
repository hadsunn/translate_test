[ ![PostgreSQL Elephant Logo](/media/img/about/press/elephant.png) ](/)

  * [Home](/ "Home")
  * [About](/about/ "About")
  * [Download](/download/ "Download")
  * [Documentation](/docs/ "Documentation")
  * [Community](/community/ "Community")
  * [Developers](/developer/ "Developers")
  * [Support](/support/ "Support")
  * [Donate](/about/donate/ "Donate")
  * [Your account](/account/ "Your account")

__

May 8, 2025: [ PostgreSQL 17.5, 16.9, 15.13, 14.18, and 13.21 Released! ](/about/news/postgresql-175-169-1513-1418-and-1321-released-3072/) | [ PostgreSQL 18 Beta 1 Released! ](/about/news/postgresql-18-beta-1-released-3070/)

[Documentation](/docs/ "Documentation") -> [PostgreSQL
16](/docs/16/index.html)

Supported Versions: [Current](/docs/current/spi-spi-execute-extended.html
"PostgreSQL 17 - SPI_execute_extended") ([17](/docs/17/spi-spi-execute-
extended.html "PostgreSQL 17 - SPI_execute_extended")) / [16](/docs/16/spi-
spi-execute-extended.html "PostgreSQL 16 - SPI_execute_extended") /
[15](/docs/15/spi-spi-execute-extended.html "PostgreSQL 15 -
SPI_execute_extended") / [14](/docs/14/spi-spi-execute-extended.html
"PostgreSQL 14 - SPI_execute_extended")

Development Versions: [18](/docs/18/spi-spi-execute-extended.html "PostgreSQL
18 - SPI_execute_extended") / [devel](/docs/devel/spi-spi-execute-
extended.html "PostgreSQL devel - SPI_execute_extended")

__

SPI_execute_extended  
---  
[Prev](spi-spi-exec.html "SPI_exec")  | [Up](spi-interface.html "47.1. Interface Functions") | 47.1. Interface Functions | [Home](index.html "PostgreSQL 16.9 Documentation") |  [Next](spi-spi-execute-with-args.html "SPI_execute_with_args")  
  
* * *

## SPI_execute_extended

SPI_execute_extended — execute a command with out-of-line parameters

## Synopsis

    
    
    int SPI_execute_extended(const char *_command_ ,
                             const SPIExecuteOptions * _options_)
    

## Description

`SPI_execute_extended` executes a command that might include references to
externally supplied parameters. The command text refers to a parameter as
`$_`n`_`, and the _`options->params`_ object (if supplied) provides values and
type information for each such symbol. Various execution options can be
specified in the _`options`_ struct, too.

The _`options->params`_ object should normally mark each parameter with the
`PARAM_FLAG_CONST` flag, since a one-shot plan is always used for the query.

If _`options->dest`_ is not NULL, then result tuples are passed to that object
as they are generated by the executor, instead of being accumulated in
`SPI_tuptable`. Using a caller-supplied `DestReceiver` object is particularly
helpful for queries that might generate many tuples, since the data can be
processed on-the-fly instead of being accumulated in memory.

## Arguments

`const char * _`command`_`

    

command string

`const SPIExecuteOptions * _`options`_`

    

struct containing optional arguments

Callers should always zero out the entire _`options`_ struct, then fill
whichever fields they want to set. This ensures forward compatibility of code,
since any fields that are added to the struct in future will be defined to
behave backwards-compatibly if they are zero. The currently available
_`options`_ fields are:

`ParamListInfo _`params`_`

    

data structure containing query parameter types and values; NULL if none

`bool _`read_only`_`

    

`true` for read-only execution

`bool _`allow_nonatomic`_`

    

`true` allows non-atomic execution of CALL and DO statements (but this field
is ignored unless the `SPI_OPT_NONATOMIC` flag was passed to
`SPI_connect_ext`)

`bool _`must_return_tuples`_`

    

if `true`, raise error if the query is not of a kind that returns tuples (this
does not forbid the case where it happens to return zero tuples)

`uint64 _`tcount`_`

    

maximum number of rows to return, or `0` for no limit

`DestReceiver * _`dest`_`

    

`DestReceiver` object that will receive any tuples emitted by the query; if
NULL, result tuples are accumulated into a `SPI_tuptable` structure, as in
`SPI_execute`

`ResourceOwner _`owner`_`

    

This field is present for consistency with `SPI_execute_plan_extended`, but it
is ignored, since the plan used by `SPI_execute_extended` is never saved.

## Return Value

The return value is the same as for `SPI_execute`.

When _`options->dest`_ is NULL, `SPI_processed` and `SPI_tuptable` are set as
in `SPI_execute`. When _`options->dest`_ is not NULL, `SPI_processed` is set
to zero and `SPI_tuptable` is set to NULL. If a tuple count is required, the
caller's `DestReceiver` object must calculate it.

* * *

[Prev](spi-spi-exec.html "SPI_exec")  | [Up](spi-interface.html "47.1. Interface Functions") |  [Next](spi-spi-execute-with-args.html "SPI_execute_with_args")  
---|---|---  
SPI_exec  | [Home](index.html "PostgreSQL 16.9 Documentation") |  SPI_execute_with_args  
  
## Submit correction

If you see anything in the documentation that is not correct, does not match
your experience with the particular feature or requires further clarification,
please use [this form](/account/comments/new/16/spi-spi-execute-
extended.html/) to report a documentation issue.

[Privacy Policy](/about/privacypolicy) | [Code of Conduct](/about/policies/coc/) | [About PostgreSQL](/about/) | [Contact](/about/contact/)  

Copyright (C) 1996-2025 The PostgreSQL Global Development Group

