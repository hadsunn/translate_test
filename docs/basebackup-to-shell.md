[ ![PostgreSQL Elephant Logo](/media/img/about/press/elephant.png) ](/)

  * [Home](/ "Home")
  * [About](/about/ "About")
  * [Download](/download/ "Download")
  * [Documentation](/docs/ "Documentation")
  * [Community](/community/ "Community")
  * [Developers](/developer/ "Developers")
  * [Support](/support/ "Support")
  * [Donate](/about/donate/ "Donate")
  * [Your account](/account/ "Your account")

__

May 8, 2025: [ PostgreSQL 17.5, 16.9, 15.13, 14.18, and 13.21 Released! ](/about/news/postgresql-175-169-1513-1418-and-1321-released-3072/) | [ PostgreSQL 18 Beta 1 Released! ](/about/news/postgresql-18-beta-1-released-3070/)

[Documentation](/docs/ "Documentation") -> [PostgreSQL
16](/docs/16/index.html)

Supported Versions: [Current](/docs/current/basebackup-to-shell.html
"PostgreSQL 17 - F.5. basebackup_to_shell — example "shell" pg_basebackup
module") ([17](/docs/17/basebackup-to-shell.html "PostgreSQL 17 -
F.5. basebackup_to_shell — example "shell" pg_basebackup module")) /
[16](/docs/16/basebackup-to-shell.html "PostgreSQL 16 -
F.5. basebackup_to_shell — example "shell" pg_basebackup module") /
[15](/docs/15/basebackup-to-shell.html "PostgreSQL 15 -
F.5. basebackup_to_shell — example "shell" pg_basebackup module")

Development Versions: [18](/docs/18/basebackup-to-shell.html "PostgreSQL 18 -
F.5. basebackup_to_shell — example "shell" pg_basebackup module") /
[devel](/docs/devel/basebackup-to-shell.html "PostgreSQL devel -
F.5. basebackup_to_shell — example "shell" pg_basebackup module")

__

F.5. basebackup_to_shell — example "shell" pg_basebackup module  
---  
[Prev](auto-explain.html "F.4. auto_explain — log execution plans of slow queries")  | [Up](contrib.html "Appendix F. Additional Supplied Modules and Extensions") | Appendix F. Additional Supplied Modules and Extensions | [Home](index.html "PostgreSQL 16.9 Documentation") |  [Next](basic-archive.html "F.6. basic_archive — an example WAL archive module")  
  
* * *

## F.5. basebackup_to_shell — example "shell" pg_basebackup module #

[F.5.1. Configuration Parameters](basebackup-to-shell.html#BASEBACKUP-TO-
SHELL-CONFIGURATION-PARAMETERS)

[F.5.2. Author](basebackup-to-shell.html#BASEBACKUP-TO-SHELL-AUTHOR)

`basebackup_to_shell` adds a custom basebackup target called `shell`. This
makes it possible to run `pg_basebackup --target=shell` or, depending on how
this module is configured, `pg_basebackup --target=shell:_`DETAIL_STRING`_`,
and cause a server command chosen by the server administrator to be executed
for each tar archive generated by the backup process. The command will receive
the contents of the archive via standard input.

This module is primarily intended as an example of how to create a new backup
targets via an extension module, but in some scenarios it may be useful for
its own sake. In order to function, this module must be loaded via
[shared_preload_libraries](runtime-config-client.html#GUC-SHARED-PRELOAD-
LIBRARIES) or [local_preload_libraries](runtime-config-client.html#GUC-LOCAL-
PRELOAD-LIBRARIES).

### F.5.1. Configuration Parameters #

`basebackup_to_shell.command` (`string`)

    

The command which the server should execute for each archive generated by the
backup process. If `%f` occurs in the command string, it will be replaced by
the name of the archive (e.g. `base.tar`). If `%d` occurs in the command
string, it will be replaced by the target detail provided by the user. A
target detail is required if `%d` is used in the command string, and
prohibited otherwise. For security reasons, it may contain only alphanumeric
characters. If `%%` occurs in the command string, it will be replaced by a
single `%`. If `%` occurs in the command string followed by any other
character or at the end of the string, an error occurs.

`basebackup_to_shell.required_role` (`string`)

    

The role required in order to make use of the `shell` backup target. If this
is not set, any replication user may make use of the `shell` backup target.

### F.5.2. Author #

Robert Haas `<[rhaas@postgresql.org](mailto:rhaas@postgresql.org)>`

* * *

[Prev](auto-explain.html "F.4. auto_explain — log execution plans of slow queries")  | [Up](contrib.html "Appendix F. Additional Supplied Modules and Extensions") |  [Next](basic-archive.html "F.6. basic_archive — an example WAL archive module")  
---|---|---  
F.4. auto_explain — log execution plans of slow queries  | [Home](index.html "PostgreSQL 16.9 Documentation") |  F.6. basic_archive — an example WAL archive module  
  
## Submit correction

If you see anything in the documentation that is not correct, does not match
your experience with the particular feature or requires further clarification,
please use [this form](/account/comments/new/16/basebackup-to-shell.html/) to
report a documentation issue.

[Privacy Policy](/about/privacypolicy) | [Code of Conduct](/about/policies/coc/) | [About PostgreSQL](/about/) | [Contact](/about/contact/)  

Copyright (C) 1996-2025 The PostgreSQL Global Development Group

